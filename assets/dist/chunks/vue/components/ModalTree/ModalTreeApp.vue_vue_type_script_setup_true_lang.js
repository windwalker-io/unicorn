import { defineComponent, provide, ref, watch, computed } from "vue";
import { T as TreeModal } from "./TreeModal.js";
import { f as cloneDeep } from "../../../composable/useQueue.js";
import { f as forceArray } from "../../../service/helper.js";
const _sfc_main = /* @__PURE__ */ defineComponent({
  __name: "ModalTreeApp",
  props: {
    id: {},
    name: {},
    title: {},
    disabled: { type: Boolean },
    readonly: { type: Boolean },
    value: {},
    source: {},
    items: {},
    valueGetter: { type: Function, default: (item) => item.id },
    titleGetter: { type: Function, default: (item) => item.title },
    searchMatcher: {},
    modalTitle: {},
    vertical: { type: Boolean },
    branchSelectable: { type: Boolean, default: false },
    selectAllChildren: { type: Boolean, default: false },
    placeholder: { default: "- No selected -" },
    multiple: { type: Boolean, default: false },
    buttonText: { default: "Select" },
    itemClass: { default: "badge bg-primary badge-pill" },
    searchText: { default: "Search" }
  },
  setup(__props, { expose: __expose }) {
    __expose();
    const props = __props;
    provide("id", props.id);
    provide("name", props.name);
    provide("multiple", props.multiple);
    provide("valueGetter", props.valueGetter);
    provide("titleGetter", props.titleGetter);
    provide("searchMatcher", props.searchMatcher ?? defaultSearchMatcher);
    function defaultSearchMatcher(item, q) {
      return props.titleGetter(item).toLowerCase().includes(q.toLowerCase());
    }
    const selected = ref([]);
    const value = ref(forceArray(props.value));
    const treeModalOpen = ref(false);
    function openSelector() {
      treeModalOpen.value = true;
    }
    function deleteItem(i, node) {
      selected.value = selected.value.filter((it) => props.valueGetter(it.value) !== props.valueGetter(node.value));
    }
    function handleSelected(items) {
      selected.value = cloneDeep(items);
    }
    watch(() => props.items, async (v) => {
      if (typeof v === "function") {
        v = await v();
      }
      selected.value = forceArray(v).filter((node) => {
        return value.value.includes(props.valueGetter(node.value));
      });
    }, { immediate: true });
    const selectedValues = computed(() => {
      return selected.value.map((node) => props.valueGetter(node.value));
    });
    const canModify = computed(() => {
      return !props.readonly && !props.disabled;
    });
    const __returned__ = { props, defaultSearchMatcher, selected, value, treeModalOpen, openSelector, deleteItem, handleSelected, selectedValues, canModify, TreeModal };
    Object.defineProperty(__returned__, "__isScriptSetup", { enumerable: false, value: true });
    return __returned__;
  }
});
export {
  _sfc_main as _
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTW9kYWxUcmVlQXBwLnZ1ZV92dWVfdHlwZV9zY3JpcHRfc2V0dXBfdHJ1ZV9sYW5nLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvdnVlL2NvbXBvbmVudHMvTW9kYWxUcmVlL01vZGFsVHJlZUFwcC52dWUiXSwic291cmNlc0NvbnRlbnQiOlsiPHNjcmlwdCBsYW5nPVwidHNcIiBzZXR1cD5cclxuaW1wb3J0IHsgY2xvbmVEZWVwIH0gZnJvbSAnbG9kYXNoLWVzJztcclxuaW1wb3J0IHsgY29tcHV0ZWQsIHByb3ZpZGUsIHJlZiwgd2F0Y2ggfSBmcm9tICd2dWUnO1xyXG5pbXBvcnQgeyBmb3JjZUFycmF5IH0gZnJvbSAnLi4vLi4vLi4vc2VydmljZSc7XHJcbmltcG9ydCB7XHJcbiAgVmFsdWVHZXR0ZXIsXHJcbiAgTW9kYWxUcmVlU291cmNlLFxyXG4gIFRpdGxlR2V0dGVyLFxyXG4gIFRyZWVOb2RlLFxyXG4gIFNlYXJjaE1hdGNoZXIsXHJcbiAgTWF5YmVBcnJheSxcclxuICBNYXliZVByb21pc2VcclxufSBmcm9tICcuLi8uLi8uLi90eXBlcyc7XHJcbmltcG9ydCBUcmVlTW9kYWwgZnJvbSAnLi9UcmVlTW9kYWwudnVlJztcclxuXHJcbmNvbnN0IHByb3BzID0gd2l0aERlZmF1bHRzKFxyXG4gIGRlZmluZVByb3BzPHtcclxuICAgIGlkPzogc3RyaW5nO1xyXG4gICAgbmFtZT86IHN0cmluZztcclxuICAgIHRpdGxlPzogc3RyaW5nO1xyXG4gICAgZGlzYWJsZWQ/OiBib29sZWFuO1xyXG4gICAgcmVhZG9ubHk/OiBib29sZWFuO1xyXG4gICAgdmFsdWU/OiBNYXliZUFycmF5PHN0cmluZyB8IG51bWJlcj47XHJcbiAgICBzb3VyY2U/OiBNb2RhbFRyZWVTb3VyY2U7XHJcbiAgICBpdGVtcz86IE1heWJlQXJyYXk8VHJlZU5vZGU+IHwgKCgpID0+IE1heWJlUHJvbWlzZTxNYXliZUFycmF5PFRyZWVOb2RlPj4pO1xyXG4gICAgdmFsdWVHZXR0ZXI/OiBWYWx1ZUdldHRlcjtcclxuICAgIHRpdGxlR2V0dGVyPzogVGl0bGVHZXR0ZXI7XHJcbiAgICBzZWFyY2hNYXRjaGVyPzogU2VhcmNoTWF0Y2hlcjtcclxuICAgIG1vZGFsVGl0bGU/OiBzdHJpbmc7XHJcbiAgICB2ZXJ0aWNhbD86IGJvb2xlYW47XHJcbiAgICBicmFuY2hTZWxlY3RhYmxlPzogYm9vbGVhbjtcclxuICAgIHNlbGVjdEFsbENoaWxkcmVuPzogYm9vbGVhbjtcclxuICAgIHBsYWNlaG9sZGVyPzogc3RyaW5nO1xyXG4gICAgbXVsdGlwbGU/OiBib29sZWFuO1xyXG4gICAgYnV0dG9uVGV4dD86IHN0cmluZztcclxuICAgIGl0ZW1DbGFzcz86IHN0cmluZztcclxuICAgIHNlYXJjaFRleHQ/OiBzdHJpbmc7XHJcbiAgfT4oKSxcclxuICB7XHJcbiAgICBicmFuY2hTZWxlY3RhYmxlOiBmYWxzZSxcclxuICAgIHNlbGVjdEFsbENoaWxkcmVuOiBmYWxzZSxcclxuICAgIHBsYWNlaG9sZGVyOiAnLSBObyBzZWxlY3RlZCAtJyxcclxuICAgIG11bHRpcGxlOiBmYWxzZSxcclxuICAgIGJ1dHRvblRleHQ6ICdTZWxlY3QnLFxyXG4gICAgaXRlbUNsYXNzOiAnYmFkZ2UgYmctcHJpbWFyeSBiYWRnZS1waWxsJyxcclxuICAgIHNlYXJjaFRleHQ6ICdTZWFyY2gnLFxyXG4gICAgdmFsdWVHZXR0ZXI6IChpdGVtOiBhbnkpID0+IGl0ZW0uaWQsXHJcbiAgICB0aXRsZUdldHRlcjogKGl0ZW06IGFueSkgPT4gaXRlbS50aXRsZSxcclxuICB9XHJcbik7XHJcblxyXG5wcm92aWRlKCdpZCcsIHByb3BzLmlkKTtcclxucHJvdmlkZSgnbmFtZScsIHByb3BzLm5hbWUpO1xyXG5wcm92aWRlKCdtdWx0aXBsZScsIHByb3BzLm11bHRpcGxlKTtcclxucHJvdmlkZSgndmFsdWVHZXR0ZXInLCBwcm9wcy52YWx1ZUdldHRlcik7XHJcbnByb3ZpZGUoJ3RpdGxlR2V0dGVyJywgcHJvcHMudGl0bGVHZXR0ZXIpO1xyXG5wcm92aWRlKCdzZWFyY2hNYXRjaGVyJywgcHJvcHMuc2VhcmNoTWF0Y2hlciA/PyBkZWZhdWx0U2VhcmNoTWF0Y2hlcik7XHJcblxyXG5mdW5jdGlvbiBkZWZhdWx0U2VhcmNoTWF0Y2hlcihpdGVtOiBhbnksIHE6IHN0cmluZykge1xyXG4gIHJldHVybiBwcm9wcy50aXRsZUdldHRlcihpdGVtKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHEudG9Mb3dlckNhc2UoKSk7XHJcbn1cclxuXHJcbmNvbnN0IHNlbGVjdGVkID0gcmVmPFRyZWVOb2RlW10+KFtdKTtcclxuY29uc3QgdmFsdWUgPSByZWY8KHN0cmluZ3xudW1iZXIpW10+KGZvcmNlQXJyYXkocHJvcHMudmFsdWUpKTtcclxuXHJcbi8vIE1vZGFsXHJcbmNvbnN0IHRyZWVNb2RhbE9wZW4gPSByZWYoZmFsc2UpO1xyXG5cclxuZnVuY3Rpb24gb3BlblNlbGVjdG9yKCkge1xyXG4gIHRyZWVNb2RhbE9wZW4udmFsdWUgPSB0cnVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkZWxldGVJdGVtKGk6IG51bWJlciwgbm9kZTogVHJlZU5vZGUpIHtcclxuICBzZWxlY3RlZC52YWx1ZSA9IHNlbGVjdGVkLnZhbHVlLmZpbHRlcigoaXQ6IFRyZWVOb2RlKSA9PiBwcm9wcy52YWx1ZUdldHRlcihpdC52YWx1ZSkgIT09IHByb3BzLnZhbHVlR2V0dGVyKG5vZGUudmFsdWUpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlU2VsZWN0ZWQoaXRlbXM6IGFueVtdKSB7XHJcbiAgc2VsZWN0ZWQudmFsdWUgPSBjbG9uZURlZXAoaXRlbXMpO1xyXG59XHJcblxyXG53YXRjaCgoKSA9PiBwcm9wcy5pdGVtcywgYXN5bmMgKHYpID0+IHtcclxuICBpZiAodHlwZW9mIHYgPT09ICdmdW5jdGlvbicpIHtcclxuICAgIHYgPSBhd2FpdCB2KCk7XHJcbiAgfVxyXG5cclxuICBzZWxlY3RlZC52YWx1ZSA9IGZvcmNlQXJyYXkodikuZmlsdGVyKChub2RlOiBUcmVlTm9kZSkgPT4ge1xyXG4gICAgcmV0dXJuIHZhbHVlLnZhbHVlLmluY2x1ZGVzKHByb3BzLnZhbHVlR2V0dGVyKG5vZGUudmFsdWUpKTtcclxuICB9KTtcclxufSwgeyBpbW1lZGlhdGU6IHRydWUgfSk7XHJcblxyXG5jb25zdCBzZWxlY3RlZFZhbHVlcyA9IGNvbXB1dGVkKCgpID0+IHtcclxuICByZXR1cm4gc2VsZWN0ZWQudmFsdWUubWFwKG5vZGUgPT4gcHJvcHMudmFsdWVHZXR0ZXIobm9kZS52YWx1ZSkpO1xyXG59KTtcclxuXHJcbmNvbnN0IGNhbk1vZGlmeSA9IGNvbXB1dGVkKCgpID0+IHtcclxuICByZXR1cm4gIXByb3BzLnJlYWRvbmx5ICYmICFwcm9wcy5kaXNhYmxlZDtcclxufSk7XHJcblxyXG48L3NjcmlwdD5cclxuXHJcbjx0ZW1wbGF0ZT5cclxuICA8ZGl2IGNsYXNzPVwiYy1tb2RhbC10cmVlXCI+XHJcbiAgICA8ZGl2IGNsYXNzPVwiYy1tb2RhbC10cmVlX19jb250YWluZXIgcC0yIGQtZmxleCBmbGV4LWNvbHVtblwiXHJcbiAgICAgIDpjbGFzcz1cIlsgdmVydGljYWwgPyAnJyA6ICdmbGV4LW1kLXJvdycgXVwiPlxyXG4gICAgICA8ZGl2IHYtaWY9XCJjYW5Nb2RpZnlcIiBjbGFzcz1cIm1lLTIgbWItMlwiXHJcbiAgICAgICAgOmNsYXNzPVwieyAnbWItbWQtMCc6ICF2ZXJ0aWNhbCB9XCI+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImJ0bi1ncm91cFwiPlxyXG4gICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tc2Vjb25kYXJ5IGJ0bi1zbSBidG4tcm91bmRlZCB0ZXh0LW5vd3JhcFwiIHR5cGU9XCJidXR0b25cIlxyXG4gICAgICAgICAgICBAY2xpY2s9XCJvcGVuU2VsZWN0b3JcIj5cclxuICAgICAgICAgICAge3sgYnV0dG9uVGV4dCB9fVxyXG4gICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1zZWNvbmRhcnkgYnRuLXNtIGJ0bi1yb3VuZGVkXCIgdHlwZT1cImJ1dHRvblwiXHJcbiAgICAgICAgICAgIEBjbGljaz1cInNlbGVjdGVkID0gW11cIj5cclxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJmYSBmYS10aW1lc1wiPjwvc3Bhbj5cclxuICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuXHJcbiAgICAgIDxkaXYgdi1pZj1cInNlbGVjdGVkLmxlbmd0aCA+IDBcIj5cclxuICAgICAgICA8VHJhbnNpdGlvbkdyb3VwIG5hbWU9XCJmYWRlXCI+XHJcbiAgICAgICAgICA8c3BhbiB2LWZvcj1cIihub2RlLCBpKSBvZiBzZWxlY3RlZFwiXHJcbiAgICAgICAgICAgIGNsYXNzPVwibWUtMiBtYi0yIGMtaXRlbVwiXHJcbiAgICAgICAgICAgIDpjbGFzcz1cIml0ZW1DbGFzc1wiXHJcbiAgICAgICAgICAgIDprZXk9XCJ2YWx1ZUdldHRlcihub2RlLnZhbHVlKVwiXHJcbiAgICAgICAgICAgIHN0eWxlPVwiYW5pbWF0aW9uLWR1cmF0aW9uOiAuM3NcIj5cclxuICAgICAgICAgICAgPHNwYW4+e3sgdGl0bGVHZXR0ZXIobm9kZS52YWx1ZSkgfX08L3NwYW4+XHJcbiAgICAgICAgICAgIDxzcGFuIHR5cGU9XCJidXR0b25cIiB2LWlmPVwiY2FuTW9kaWZ5XCJcclxuICAgICAgICAgICAgICBAY2xpY2sucHJldmVudD1cImRlbGV0ZUl0ZW0oaSwgbm9kZSlcIiBjbGFzcz1cIm1zLTJcIiBzdHlsZT1cImN1cnNvcjogcG9pbnRlclwiPlxyXG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZmEgZmEtdGltZXNcIj48L3NwYW4+XHJcbiAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICA8L1RyYW5zaXRpb25Hcm91cD5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxkaXYgdi1lbHNlIGNsYXNzPVwidGV4dC1tdXRlZFwiPlxyXG4gICAgICAgIHt7IHBsYWNlaG9sZGVyIH19XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcblxyXG4gICAgPHNlbGVjdCBtdWx0aXBsZVxyXG4gICAgICBzdHlsZT1cImRpc3BsYXk6IG5vbmU7XCJcclxuICAgICAgcmVmPVwiaW5wdXRcIlxyXG4gICAgICA6aWQ9XCJpZFwiXHJcbiAgICAgIDpuYW1lPVwibmFtZVwiXHJcbiAgICAgIDpkaXNhYmxlZD1cImRpc2FibGVkXCJcclxuICAgICAgOnJlYWRvbmx5PVwicmVhZG9ubHlcIlxyXG4gICAgICB2LWJpbmQ9XCIkYXR0cnNcIlxyXG4gICAgPlxyXG4gICAgICA8b3B0aW9uIHYtZm9yPVwiaWQgb2Ygc2VsZWN0ZWRWYWx1ZXNcIiA6dmFsdWU9XCJpZFwiIDpzZWxlY3RlZD1cInRydWVcIj57eyBpZCB9fTwvb3B0aW9uPlxyXG4gICAgPC9zZWxlY3Q+XHJcblxyXG4gICAgPFRyZWVNb2RhbFxyXG4gICAgICA6b3Blbj1cInRyZWVNb2RhbE9wZW5cIlxyXG4gICAgICBAaGlkZT1cInRyZWVNb2RhbE9wZW4gPSBmYWxzZVwiXHJcbiAgICAgIDppZD1cImlkXCJcclxuICAgICAgOnRpdGxlPVwibW9kYWxUaXRsZVwiXHJcbiAgICAgIDpzb3VyY2U9XCJzb3VyY2VcIlxyXG4gICAgICA6dmFsdWU9XCJzZWxlY3RlZFZhbHVlc1wiXHJcbiAgICAgIDpicmFuY2hTZWxlY3RhYmxlXHJcbiAgICAgIHYtYmluZD1cIiRhdHRyc1wiXHJcbiAgICAgIDpkaXNhYmxlZD1cImRpc2FibGVkXCJcclxuICAgICAgOnJlYWRvbmx5PVwicmVhZG9ubHlcIlxyXG4gICAgICA6c2VhcmNoLXRleHQ9XCJzZWFyY2hUZXh0XCJcclxuICAgICAgQHNlbGVjdGVkPVwiaGFuZGxlU2VsZWN0ZWRcIlxyXG4gICAgLz5cclxuICA8L2Rpdj5cclxuPC90ZW1wbGF0ZT5cclxuXHJcbjxzdHlsZSBzY29wZWQ+XHJcbi5jLWl0ZW0ge1xyXG4gIHBhZGRpbmctbGVmdDogLjc1cmVtO1xyXG4gIHBhZGRpbmctcmlnaHQ6IC43NXJlbTtcclxuICBwYWRkaW5nLXRvcDogLjVyZW07XHJcbiAgcGFkZGluZy1ib3R0b206IC41cmVtO1xyXG59XHJcbjwvc3R5bGU+XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFlQSxVQUFNLFFBQVE7QUFvQ2QsWUFBUSxNQUFNLE1BQU0sRUFBRTtBQUN0QixZQUFRLFFBQVEsTUFBTSxJQUFJO0FBQzFCLFlBQVEsWUFBWSxNQUFNLFFBQVE7QUFDbEMsWUFBUSxlQUFlLE1BQU0sV0FBVztBQUN4QyxZQUFRLGVBQWUsTUFBTSxXQUFXO0FBQ3hDLFlBQVEsaUJBQWlCLE1BQU0saUJBQWlCLG9CQUFvQjtBQUVwRSxhQUFTLHFCQUFxQixNQUFXLEdBQVc7QUFDbEQsYUFBTyxNQUFNLFlBQVksSUFBSSxFQUFFLGNBQWMsU0FBUyxFQUFFLGFBQWE7QUFBQSxJQUN2RTtBQUVBLFVBQU0sV0FBVyxJQUFnQixFQUFFO0FBQ25DLFVBQU0sUUFBUSxJQUF1QixXQUFXLE1BQU0sS0FBSyxDQUFDO0FBRzVELFVBQU0sZ0JBQWdCLElBQUksS0FBSztBQUUvQixhQUFTLGVBQWU7QUFDdEIsb0JBQWMsUUFBUTtBQUFBLElBQ3hCO0FBRUEsYUFBUyxXQUFXLEdBQVcsTUFBZ0I7QUFDN0MsZUFBUyxRQUFRLFNBQVMsTUFBTSxPQUFPLENBQUMsT0FBaUIsTUFBTSxZQUFZLEdBQUcsS0FBSyxNQUFNLE1BQU0sWUFBWSxLQUFLLEtBQUssQ0FBQztBQUFBLElBQ3hIO0FBRUEsYUFBUyxlQUFlLE9BQWM7QUFDcEMsZUFBUyxRQUFRLFVBQVUsS0FBSztBQUFBLElBQ2xDO0FBRUEsVUFBTSxNQUFNLE1BQU0sT0FBTyxPQUFPLE1BQU07QUFDcEMsVUFBSSxPQUFPLE1BQU0sWUFBWTtBQUMzQixZQUFJLE1BQU0sRUFBQTtBQUFBLE1BQ1o7QUFFQSxlQUFTLFFBQVEsV0FBVyxDQUFDLEVBQUUsT0FBTyxDQUFDLFNBQW1CO0FBQ3hELGVBQU8sTUFBTSxNQUFNLFNBQVMsTUFBTSxZQUFZLEtBQUssS0FBSyxDQUFDO0FBQUEsTUFDM0QsQ0FBQztBQUFBLElBQ0gsR0FBRyxFQUFFLFdBQVcsTUFBTTtBQUV0QixVQUFNLGlCQUFpQixTQUFTLE1BQU07QUFDcEMsYUFBTyxTQUFTLE1BQU0sSUFBSSxDQUFBLFNBQVEsTUFBTSxZQUFZLEtBQUssS0FBSyxDQUFDO0FBQUEsSUFDakUsQ0FBQztBQUVELFVBQU0sWUFBWSxTQUFTLE1BQU07QUFDL0IsYUFBTyxDQUFDLE1BQU0sWUFBWSxDQUFDLE1BQU07QUFBQSxJQUNuQyxDQUFDOzs7Ozs7In0=
