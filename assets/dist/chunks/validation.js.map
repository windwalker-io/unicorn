{"version":3,"file":"validation.js","sources":["../../../../../../node_modules/punycode/punycode.es6.js","../../src/module/validation.ts"],"sourcesContent":["'use strict';\n\n/** Highest positive signed 32-bit float value */\nconst maxInt = 2147483647; // aka. 0x7FFFFFFF or 2^31-1\n\n/** Bootstring parameters */\nconst base = 36;\nconst tMin = 1;\nconst tMax = 26;\nconst skew = 38;\nconst damp = 700;\nconst initialBias = 72;\nconst initialN = 128; // 0x80\nconst delimiter = '-'; // '\\x2D'\n\n/** Regular expressions */\nconst regexPunycode = /^xn--/;\nconst regexNonASCII = /[^\\0-\\x7F]/; // Note: U+007F DEL is excluded too.\nconst regexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g; // RFC 3490 separators\n\n/** Error messages */\nconst errors = {\n\t'overflow': 'Overflow: input needs wider integers to process',\n\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t'invalid-input': 'Invalid input'\n};\n\n/** Convenience shortcuts */\nconst baseMinusTMin = base - tMin;\nconst floor = Math.floor;\nconst stringFromCharCode = String.fromCharCode;\n\n/*--------------------------------------------------------------------------*/\n\n/**\n * A generic error utility function.\n * @private\n * @param {String} type The error type.\n * @returns {Error} Throws a `RangeError` with the applicable error message.\n */\nfunction error(type) {\n\tthrow new RangeError(errors[type]);\n}\n\n/**\n * A generic `Array#map` utility function.\n * @private\n * @param {Array} array The array to iterate over.\n * @param {Function} callback The function that gets called for every array\n * item.\n * @returns {Array} A new array of values returned by the callback function.\n */\nfunction map(array, callback) {\n\tconst result = [];\n\tlet length = array.length;\n\twhile (length--) {\n\t\tresult[length] = callback(array[length]);\n\t}\n\treturn result;\n}\n\n/**\n * A simple `Array#map`-like wrapper to work with domain name strings or email\n * addresses.\n * @private\n * @param {String} domain The domain name or email address.\n * @param {Function} callback The function that gets called for every\n * character.\n * @returns {String} A new string of characters returned by the callback\n * function.\n */\nfunction mapDomain(domain, callback) {\n\tconst parts = domain.split('@');\n\tlet result = '';\n\tif (parts.length > 1) {\n\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t// the local part (i.e. everything up to `@`) intact.\n\t\tresult = parts[0] + '@';\n\t\tdomain = parts[1];\n\t}\n\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\tdomain = domain.replace(regexSeparators, '\\x2E');\n\tconst labels = domain.split('.');\n\tconst encoded = map(labels, callback).join('.');\n\treturn result + encoded;\n}\n\n/**\n * Creates an array containing the numeric code points of each Unicode\n * character in the string. While JavaScript uses UCS-2 internally,\n * this function will convert a pair of surrogate halves (each of which\n * UCS-2 exposes as separate characters) into a single code point,\n * matching UTF-16.\n * @see `punycode.ucs2.encode`\n * @see <https://mathiasbynens.be/notes/javascript-encoding>\n * @memberOf punycode.ucs2\n * @name decode\n * @param {String} string The Unicode input string (UCS-2).\n * @returns {Array} The new array of code points.\n */\nfunction ucs2decode(string) {\n\tconst output = [];\n\tlet counter = 0;\n\tconst length = string.length;\n\twhile (counter < length) {\n\t\tconst value = string.charCodeAt(counter++);\n\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t// It's a high surrogate, and there is a next character.\n\t\t\tconst extra = string.charCodeAt(counter++);\n\t\t\tif ((extra & 0xFC00) == 0xDC00) { // Low surrogate.\n\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t} else {\n\t\t\t\t// It's an unmatched surrogate; only append this code unit, in case the\n\t\t\t\t// next code unit is the high surrogate of a surrogate pair.\n\t\t\t\toutput.push(value);\n\t\t\t\tcounter--;\n\t\t\t}\n\t\t} else {\n\t\t\toutput.push(value);\n\t\t}\n\t}\n\treturn output;\n}\n\n/**\n * Creates a string based on an array of numeric code points.\n * @see `punycode.ucs2.decode`\n * @memberOf punycode.ucs2\n * @name encode\n * @param {Array} codePoints The array of numeric code points.\n * @returns {String} The new Unicode string (UCS-2).\n */\nconst ucs2encode = codePoints => String.fromCodePoint(...codePoints);\n\n/**\n * Converts a basic code point into a digit/integer.\n * @see `digitToBasic()`\n * @private\n * @param {Number} codePoint The basic numeric code point value.\n * @returns {Number} The numeric value of a basic code point (for use in\n * representing integers) in the range `0` to `base - 1`, or `base` if\n * the code point does not represent a value.\n */\nconst basicToDigit = function(codePoint) {\n\tif (codePoint >= 0x30 && codePoint < 0x3A) {\n\t\treturn 26 + (codePoint - 0x30);\n\t}\n\tif (codePoint >= 0x41 && codePoint < 0x5B) {\n\t\treturn codePoint - 0x41;\n\t}\n\tif (codePoint >= 0x61 && codePoint < 0x7B) {\n\t\treturn codePoint - 0x61;\n\t}\n\treturn base;\n};\n\n/**\n * Converts a digit/integer into a basic code point.\n * @see `basicToDigit()`\n * @private\n * @param {Number} digit The numeric value of a basic code point.\n * @returns {Number} The basic code point whose value (when used for\n * representing integers) is `digit`, which needs to be in the range\n * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n * used; else, the lowercase form is used. The behavior is undefined\n * if `flag` is non-zero and `digit` has no uppercase form.\n */\nconst digitToBasic = function(digit, flag) {\n\t//  0..25 map to ASCII a..z or A..Z\n\t// 26..35 map to ASCII 0..9\n\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n};\n\n/**\n * Bias adaptation function as per section 3.4 of RFC 3492.\n * https://tools.ietf.org/html/rfc3492#section-3.4\n * @private\n */\nconst adapt = function(delta, numPoints, firstTime) {\n\tlet k = 0;\n\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\tdelta += floor(delta / numPoints);\n\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\tdelta = floor(delta / baseMinusTMin);\n\t}\n\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n};\n\n/**\n * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n * symbols.\n * @memberOf punycode\n * @param {String} input The Punycode string of ASCII-only symbols.\n * @returns {String} The resulting string of Unicode symbols.\n */\nconst decode = function(input) {\n\t// Don't use UCS-2.\n\tconst output = [];\n\tconst inputLength = input.length;\n\tlet i = 0;\n\tlet n = initialN;\n\tlet bias = initialBias;\n\n\t// Handle the basic code points: let `basic` be the number of input code\n\t// points before the last delimiter, or `0` if there is none, then copy\n\t// the first basic code points to the output.\n\n\tlet basic = input.lastIndexOf(delimiter);\n\tif (basic < 0) {\n\t\tbasic = 0;\n\t}\n\n\tfor (let j = 0; j < basic; ++j) {\n\t\t// if it's not a basic code point\n\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\terror('not-basic');\n\t\t}\n\t\toutput.push(input.charCodeAt(j));\n\t}\n\n\t// Main decoding loop: start just after the last delimiter if any basic code\n\t// points were copied; start at the beginning otherwise.\n\n\tfor (let index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t// `index` is the index of the next character to be consumed.\n\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t// which gets added to `i`. The overflow checking is easier\n\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t// value at the end to obtain `delta`.\n\t\tconst oldi = i;\n\t\tfor (let w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\tif (index >= inputLength) {\n\t\t\t\terror('invalid-input');\n\t\t\t}\n\n\t\t\tconst digit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\tif (digit >= base) {\n\t\t\t\terror('invalid-input');\n\t\t\t}\n\t\t\tif (digit > floor((maxInt - i) / w)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\ti += digit * w;\n\t\t\tconst t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\tif (digit < t) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst baseMinusT = base - t;\n\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tw *= baseMinusT;\n\n\t\t}\n\n\t\tconst out = output.length + 1;\n\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t// incrementing `n` each time, so we'll fix that now:\n\t\tif (floor(i / out) > maxInt - n) {\n\t\t\terror('overflow');\n\t\t}\n\n\t\tn += floor(i / out);\n\t\ti %= out;\n\n\t\t// Insert `n` at position `i` of the output.\n\t\toutput.splice(i++, 0, n);\n\n\t}\n\n\treturn String.fromCodePoint(...output);\n};\n\n/**\n * Converts a string of Unicode symbols (e.g. a domain name label) to a\n * Punycode string of ASCII-only symbols.\n * @memberOf punycode\n * @param {String} input The string of Unicode symbols.\n * @returns {String} The resulting Punycode string of ASCII-only symbols.\n */\nconst encode = function(input) {\n\tconst output = [];\n\n\t// Convert the input in UCS-2 to an array of Unicode code points.\n\tinput = ucs2decode(input);\n\n\t// Cache the length.\n\tconst inputLength = input.length;\n\n\t// Initialize the state.\n\tlet n = initialN;\n\tlet delta = 0;\n\tlet bias = initialBias;\n\n\t// Handle the basic code points.\n\tfor (const currentValue of input) {\n\t\tif (currentValue < 0x80) {\n\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t}\n\t}\n\n\tconst basicLength = output.length;\n\tlet handledCPCount = basicLength;\n\n\t// `handledCPCount` is the number of code points that have been handled;\n\t// `basicLength` is the number of basic code points.\n\n\t// Finish the basic string with a delimiter unless it's empty.\n\tif (basicLength) {\n\t\toutput.push(delimiter);\n\t}\n\n\t// Main encoding loop:\n\twhile (handledCPCount < inputLength) {\n\n\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t// larger one:\n\t\tlet m = maxInt;\n\t\tfor (const currentValue of input) {\n\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\tm = currentValue;\n\t\t\t}\n\t\t}\n\n\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t// but guard against overflow.\n\t\tconst handledCPCountPlusOne = handledCPCount + 1;\n\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\terror('overflow');\n\t\t}\n\n\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\tn = m;\n\n\t\tfor (const currentValue of input) {\n\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\t\t\tif (currentValue === n) {\n\t\t\t\t// Represent delta as a generalized variable-length integer.\n\t\t\t\tlet q = delta;\n\t\t\t\tfor (let k = base; /* no condition */; k += base) {\n\t\t\t\t\tconst t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tconst qMinusT = q - t;\n\t\t\t\t\tconst baseMinusT = base - t;\n\t\t\t\t\toutput.push(\n\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t);\n\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t}\n\n\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount === basicLength);\n\t\t\t\tdelta = 0;\n\t\t\t\t++handledCPCount;\n\t\t\t}\n\t\t}\n\n\t\t++delta;\n\t\t++n;\n\n\t}\n\treturn output.join('');\n};\n\n/**\n * Converts a Punycode string representing a domain name or an email address\n * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n * it doesn't matter if you call it on a string that has already been\n * converted to Unicode.\n * @memberOf punycode\n * @param {String} input The Punycoded domain name or email address to\n * convert to Unicode.\n * @returns {String} The Unicode representation of the given Punycode\n * string.\n */\nconst toUnicode = function(input) {\n\treturn mapDomain(input, function(string) {\n\t\treturn regexPunycode.test(string)\n\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t: string;\n\t});\n};\n\n/**\n * Converts a Unicode string representing a domain name or an email address to\n * Punycode. Only the non-ASCII parts of the domain name will be converted,\n * i.e. it doesn't matter if you call it with a domain that's already in\n * ASCII.\n * @memberOf punycode\n * @param {String} input The domain name or email address to convert, as a\n * Unicode string.\n * @returns {String} The Punycode representation of the given domain name or\n * email address.\n */\nconst toASCII = function(input) {\n\treturn mapDomain(input, function(string) {\n\t\treturn regexNonASCII.test(string)\n\t\t\t? 'xn--' + encode(string)\n\t\t\t: string;\n\t});\n};\n\n/*--------------------------------------------------------------------------*/\n\n/** Define the public API */\nconst punycode = {\n\t/**\n\t * A string representing the current Punycode.js version number.\n\t * @memberOf punycode\n\t * @type String\n\t */\n\t'version': '2.3.1',\n\t/**\n\t * An object of methods to convert from JavaScript's internal character\n\t * representation (UCS-2) to Unicode code points, and back.\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode\n\t * @type Object\n\t */\n\t'ucs2': {\n\t\t'decode': ucs2decode,\n\t\t'encode': ucs2encode\n\t},\n\t'decode': decode,\n\t'encode': encode,\n\t'toASCII': toASCII,\n\t'toUnicode': toUnicode\n};\n\nexport { ucs2decode, ucs2encode, decode, encode, toASCII, toUnicode };\nexport default punycode;\n","import { useUniDirective } from '../composable';\r\nimport { getBoundedInstance, html, selectAll, selectOne, trans, useUITheme } from '../service';\r\nimport { Nullable } from '../types';\r\nimport { mergeDeep } from '../utilities';\r\nimport * as punycode from 'punycode';\r\n\r\nexport declare type ValidationHandler = (value: any, input: HTMLElement, options?: Record<string, any>, fv?: UnicornFieldValidation) => any;\r\n\r\nexport declare type Validator = {\r\n  handler: ValidationHandler,\r\n  options?: Record<string, any>;\r\n};\r\n\r\nconst validatorHandlers: Record<string, ValidationHandler> = {};\r\n\r\ntype InputElements = HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement;\r\n\r\nexport interface FormValidationOptions {\r\n  scroll: boolean;\r\n  validatedClass: null;\r\n  fieldSelector: null;\r\n  scrollOffset: number;\r\n  enabled: boolean;\r\n}\r\n\r\nexport interface FieldValidationOptions {\r\n  validClass: string;\r\n  errorSelector: string;\r\n  inputOptions: boolean;\r\n  inputOptionsSelector: string;\r\n  formSelector: string;\r\n  selector: string;\r\n  inputOptionsWrapperSelector: string;\r\n  events: string[];\r\n  invalidClass: string;\r\n  errorMessageClass: string;\r\n}\r\n\r\nconst defaultOptions: FormValidationOptions = {\r\n  scroll: false,\r\n  scrollOffset: -100,\r\n  enabled: true,\r\n  fieldSelector: null,\r\n  validatedClass: null,\r\n};\r\n\r\nconst defaultFieldOptions: FieldValidationOptions = {\r\n  formSelector: '[uni-form-validate]',\r\n  errorSelector: '[data-field-error]',\r\n  selector: 'input[data-field-input], select[data-field-input], textarea[data-field-input]',\r\n  validClass: 'is-valid',\r\n  invalidClass: 'is-invalid',\r\n  events: ['change'],\r\n  errorMessageClass: 'invalid-tooltip',\r\n  inputOptions: false,\r\n  inputOptionsWrapperSelector: 'div[data-field-input]',\r\n  inputOptionsSelector: '[data-input-option]'\r\n};\r\n\r\nexport class UnicornFormValidation {\r\n  presetFields: HTMLElement[] = [];\r\n\r\n  static globalValidators: Record<string, Validator> = {};\r\n\r\n  validators: Record<string, Validator> = {};\r\n  options: FormValidationOptions;\r\n  $form: HTMLElement;\r\n\r\n  static is = 'uni-form-validate';\r\n\r\n  constructor(el: HTMLElement, options: Partial<FormValidationOptions> = {}) {\r\n    this.$form = selectOne(el);\r\n    this.options = this.mergeOptions(options);\r\n\r\n    this.registerDefaultValidators();\r\n\r\n    this.init();\r\n  }\r\n\r\n  mergeOptions(options: Partial<FormValidationOptions>) {\r\n    // Fix PHP empty array to JSON issue.\r\n    if (Array.isArray(options)) {\r\n      options = {};\r\n    }\r\n\r\n    return this.options = mergeDeep({}, defaultOptions, options);\r\n  }\r\n\r\n  get scrollEnabled() {\r\n    return this.options.scroll;\r\n  }\r\n\r\n  get scrollOffset() {\r\n    return Number(this.options.scrollOffset || -100);\r\n  }\r\n\r\n  get fieldSelector() {\r\n    return this.options.fieldSelector || 'input, select, textarea';\r\n  }\r\n\r\n  get validatedClass() {\r\n    return this.options.validatedClass || 'was-validated';\r\n  }\r\n\r\n  init() {\r\n    if (this.$form.tagName === 'FORM') {\r\n      this.$form.setAttribute('novalidate', 'true');\r\n      this.$form.addEventListener('submit', (event) => {\r\n        if (this.options.enabled && !this.validateAll()) {\r\n          event.stopImmediatePropagation(); // Stop following events\r\n          event.stopPropagation();\r\n          event.preventDefault();\r\n\r\n          this.$form.dispatchEvent(new CustomEvent('invalid'));\r\n\r\n          return false;\r\n        }\r\n\r\n        return true;\r\n      }, false);\r\n    }\r\n\r\n    this.prepareFields(this.findDOMFields());\r\n    this.prepareFields(this.presetFields);\r\n  }\r\n\r\n  findDOMFields(): HTMLElement[] {\r\n    return selectAll(this.$form.querySelectorAll<HTMLElement>(this.fieldSelector));\r\n  }\r\n\r\n  prepareFields(inputs: HTMLElement[]): Promise<void> {\r\n    inputs.forEach((input) => {\r\n      this.prepareFieldWrapper(input);\r\n    });\r\n\r\n    // Wait next tick\r\n    return Promise.resolve();\r\n  }\r\n\r\n  prepareFieldWrapper(input: HTMLElement): HTMLElement | null {\r\n    if (['INPUT', 'SELECT', 'TEXTAREA'].indexOf(input.tagName) !== -1) {\r\n      let wrapper: HTMLElement | null = input.closest('[uni-field-validate]');\r\n\r\n      if (!wrapper) {\r\n        wrapper = input.closest('[data-input-container]') || input.parentElement;\r\n\r\n        wrapper?.setAttribute('uni-field-validate', '{}');\r\n      }\r\n\r\n      return wrapper;\r\n    }\r\n\r\n    return input;\r\n  }\r\n\r\n  findFields(containsPresets: boolean = true): HTMLElement[] {\r\n    let inputs = this.findDOMFields();\r\n\r\n    if (containsPresets) {\r\n      inputs.push(...this.presetFields);\r\n    }\r\n\r\n    return inputs.map((input) => this.prepareFieldWrapper(input))\r\n      .filter(input => input != null) as HTMLElement[];\r\n  }\r\n\r\n  getFieldComponent(input: HTMLElement): UnicornFieldValidation | null {\r\n    let v = getBoundedInstance(input, 'field.validation');\r\n\r\n    if (!v) {\r\n      const wrapper = input.closest('[uni-field-validate]') as HTMLElement | null;\r\n\r\n      if (wrapper) {\r\n        v = getBoundedInstance(wrapper, 'field.validation');\r\n      }\r\n    }\r\n\r\n    return v;\r\n  }\r\n\r\n  validateAll(fields?: Nullable<HTMLElement[]>): boolean {\r\n    this.markFormAsUnvalidated();\r\n\r\n    fields = fields || this.findFields();\r\n    let firstFail: HTMLElement | null = null;\r\n\r\n    for (const field of fields) {\r\n      const fv = this.getFieldComponent(field);\r\n\r\n      if (!fv) {\r\n        continue;\r\n      }\r\n\r\n      const result = fv.checkValidity();\r\n\r\n      if (!result && !firstFail) {\r\n        firstFail = field;\r\n      }\r\n    }\r\n\r\n    this.markFormAsValidated();\r\n\r\n    if (firstFail && this.scrollEnabled) {\r\n      this.scrollTo(firstFail);\r\n    }\r\n\r\n    return firstFail === null;\r\n  }\r\n\r\n  async validateAllAsync(fields?: Nullable<HTMLElement[]>): Promise<boolean> {\r\n    this.markFormAsUnvalidated();\r\n\r\n    fields = fields || this.findFields();\r\n    let firstFail: HTMLElement | null = null;\r\n    const promises: Promise<boolean>[] = [];\r\n\r\n    for (const field of fields) {\r\n      const fv = this.getFieldComponent(field);\r\n\r\n      if (!fv) {\r\n        continue;\r\n      }\r\n\r\n      promises.push(\r\n        fv.checkValidityAsync().then((result) => {\r\n          if (!result && !firstFail) {\r\n            firstFail = field;\r\n          }\r\n\r\n          return result;\r\n        })\r\n      );\r\n    }\r\n\r\n    await Promise.all(promises);\r\n\r\n    this.markFormAsValidated();\r\n\r\n    if (firstFail && this.scrollEnabled) {\r\n      this.scrollTo(firstFail);\r\n    }\r\n\r\n    return firstFail === null;\r\n  }\r\n\r\n  scrollTo(element: HTMLElement): void {\r\n    const offset = this.scrollOffset;\r\n    const elementPosition = element.getBoundingClientRect().top;\r\n    const offsetPosition = elementPosition + window.scrollY + offset;\r\n\r\n    window.scrollTo({\r\n      top: offsetPosition,\r\n      behavior: 'smooth'\r\n    });\r\n  }\r\n\r\n  markFormAsValidated(): void {\r\n    if (!this.$form) {\r\n      return;\r\n    }\r\n\r\n    this.$form.classList.add(this.validatedClass);\r\n  }\r\n\r\n  markFormAsUnvalidated(): void {\r\n    if (!this.$form) {\r\n      return;\r\n    }\r\n\r\n    this.$form.classList.remove(this.validatedClass);\r\n  }\r\n\r\n  addField(field: HTMLElement): this {\r\n    this.presetFields.push(field);\r\n\r\n    this.prepareFieldWrapper(field);\r\n\r\n    return this;\r\n  }\r\n\r\n  registerDefaultValidators(): void {\r\n    for (let name in validatorHandlers) {\r\n      this.addValidator(name, validatorHandlers[name]);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add validator handler.\r\n   */\r\n  addValidator(name: string, handler: ValidationHandler, options: Record<string, any> = {}) {\r\n    options = options || {};\r\n\r\n    this.validators[name] = {\r\n      handler,\r\n      options\r\n    };\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Add validator handler.\r\n   */\r\n  static addGlobalValidator(name: string, handler: ValidationHandler, options: Record<string, any> = {}) {\r\n    options = options || {};\r\n\r\n    this.globalValidators[name] = {\r\n      handler,\r\n      options\r\n    };\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport class UnicornFieldValidation {\r\n  $input: InputElements | undefined;\r\n  options: FieldValidationOptions;\r\n\r\n  static is = 'uni-field-validate';\r\n\r\n  constructor(protected el: HTMLElement, options: Partial<FieldValidationOptions> = {}) {\r\n    this.options = this.mergeOptions(options);\r\n\r\n    this.$input = this.selectInput();\r\n\r\n    this.init();\r\n  }\r\n\r\n  mergeOptions(options: Partial<FieldValidationOptions>) {\r\n    // Fix PHP empty array to JSON issue.\r\n    if (Array.isArray(options)) {\r\n      options = {};\r\n    }\r\n\r\n    return this.options = mergeDeep({}, defaultFieldOptions, options);\r\n  }\r\n\r\n  get $form(): HTMLFormElement {\r\n    return this.getForm();\r\n  }\r\n\r\n  get errorSelector(): string {\r\n    return this.options.errorSelector;\r\n  }\r\n\r\n  get selector(): string {\r\n    return this.options.selector;\r\n  }\r\n\r\n  get validClass(): string {\r\n    return this.options.validClass;\r\n  }\r\n\r\n  get invalidClass(): string {\r\n    return this.options.invalidClass;\r\n  }\r\n\r\n  get isVisible(): boolean {\r\n    return !!(this.el.offsetWidth || this.el.offsetHeight || this.el.getClientRects().length);\r\n  }\r\n\r\n  get isInputOptions(): boolean {\r\n    return Boolean(this.options.inputOptions);\r\n  }\r\n\r\n  get validationMessage(): string {\r\n    return this.$input?.validationMessage || '';\r\n  }\r\n\r\n  get validity(): ValidityState | undefined {\r\n    return this.$input?.validity;\r\n  }\r\n\r\n  selectInput(): InputElements | undefined {\r\n    let selector = this.selector;\r\n\r\n    if (this.options.inputOptions) {\r\n      selector += ', ' + this.options.inputOptionsWrapperSelector;\r\n    }\r\n\r\n    let input = this.el.querySelector<InputElements>(selector);\r\n\r\n    if (!input) {\r\n      input = this.el.querySelector<InputElements>('input, select, textarea');\r\n    }\r\n\r\n    if (!input) {\r\n      return undefined;\r\n    }\r\n\r\n    return this.$input = input;\r\n  }\r\n\r\n  init() {\r\n    this.selectInput();\r\n\r\n    this.bindEvents();\r\n\r\n    this.prepareWrapper();\r\n\r\n    if (this.isInputOptions) {\r\n      const $input = this.$input as any;\r\n\r\n      $input.validationMessage = '';\r\n      $input.setCustomValidity = (msg: string) => {\r\n        $input.validationMessage = String(msg);\r\n      };\r\n\r\n      $input.checkValidity = () => {\r\n        return this.checkInputOptionsValidity();\r\n      };\r\n    }\r\n  }\r\n\r\n  bindEvents() {\r\n    if (!this.$input) {\r\n      return;\r\n    }\r\n\r\n    this.$input.addEventListener('invalid', (e) => {\r\n      this.showInvalidResponse();\r\n    });\r\n\r\n    const events = this.options.events;\r\n\r\n    events.forEach((eventName) => {\r\n      this.$input?.addEventListener(eventName, () => {\r\n        this.checkValidity();\r\n      });\r\n    });\r\n  }\r\n\r\n  prepareWrapper() {\r\n    if (this.el.querySelector(this.errorSelector)?.classList?.contains('invalid-tooltip')) {\r\n      if (window.getComputedStyle(this.el).position === 'static') {\r\n        this.el.style.position = 'relative';\r\n      }\r\n    }\r\n  }\r\n\r\n  checkValidity() {\r\n    if (!this.$input) {\r\n      return true;\r\n    }\r\n\r\n    if (this.$input.hasAttribute('readonly')) {\r\n      return true;\r\n    }\r\n\r\n    if (this.$input.hasAttribute('[data-novalidate]')) {\r\n      return true;\r\n    }\r\n\r\n    if (this.$input.closest('[data-novalidate]')) {\r\n      return true;\r\n    }\r\n\r\n    this.$input.setCustomValidity('');\r\n    let valid = this.$input.checkValidity();\r\n\r\n    if (valid && this.$form) {\r\n      valid = this.runCustomValidity();\r\n    }\r\n\r\n    // Raise invalid event\r\n    // this.$input.checkValidity();\r\n\r\n    this.updateValidClass(valid);\r\n\r\n    return valid;\r\n  }\r\n\r\n  runCustomValidity() {\r\n    if (!this.$input) {\r\n      return true;\r\n    }\r\n\r\n    // Check custom validity\r\n    const validates = (this.$input.getAttribute('data-validate') || '').split('|');\r\n    let result = true;\r\n\r\n    if (this.$input.value !== '' && validates.length) {\r\n      if (!this.checkCustomDataAttributeValidity()) {\r\n        return false;\r\n      }\r\n\r\n      for (const validatorName of validates) {\r\n        const [validator, options] = this.getValidator(validatorName) || [null, {}];\r\n\r\n        if (!validator) {\r\n          continue;\r\n        }\r\n\r\n        Object.assign(options, validator.options);\r\n\r\n        let r = validator.handler(this.$input.value, this.$input, options, this);\r\n\r\n        // If return is a promise, push to stack and resolve later\r\n        if (r instanceof Promise || (typeof r === 'object' && r.then)) {\r\n          r.then((result: boolean) => {\r\n            this.handleAsyncCustomResult(result, validator);\r\n          });\r\n          continue;\r\n        }\r\n\r\n        if (!this.handleCustomResult(r, validator)) {\r\n          result = false;\r\n\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  async checkValidityAsync() {\r\n    if (!this.$input) {\r\n      return true;\r\n    }\r\n\r\n    if (this.$input.hasAttribute('readonly')) {\r\n      return true;\r\n    }\r\n\r\n    this.$input.setCustomValidity('');\r\n    let valid = this.$input.checkValidity();\r\n\r\n    if (valid && this.$form) {\r\n      valid = await this.runCustomValidityAsync();\r\n    }\r\n\r\n    this.updateValidClass(valid);\r\n\r\n    return valid;\r\n  }\r\n\r\n  async runCustomValidityAsync(): Promise<boolean> {\r\n    if (!this.$input) {\r\n      return true;\r\n    }\r\n\r\n    // Check custom validity\r\n    const validates = (this.$input.getAttribute('data-validate') || '').split('|');\r\n\r\n    const results: Array<boolean | string | undefined> = [];\r\n    const promises: Promise<boolean>[] = [];\r\n\r\n    if (this.$input.value !== '' && validates.length) {\r\n      if (!this.checkCustomDataAttributeValidity()) {\r\n        return false;\r\n      }\r\n\r\n      for (const validatorName of validates) {\r\n        let [validator, options] = this.getValidator(validatorName) || [null, {}];\r\n\r\n        if (!validator) {\r\n          continue;\r\n        }\r\n\r\n        options = Object.assign({}, options, validator.options || {});\r\n\r\n        promises.push(\r\n          Promise.resolve(validator.handler(this.$input.value, this.$input, options, this))\r\n            .then((r) => {\r\n              results.push(this.handleAsyncCustomResult(r, validator));\r\n\r\n              return r;\r\n            })\r\n        );\r\n      }\r\n    }\r\n\r\n    await Promise.all(promises);\r\n\r\n    for (const result of results) {\r\n      if (result === false) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  checkCustomDataAttributeValidity(): boolean {\r\n    const error = this.$input?.dataset.validationFail;\r\n\r\n    return this.handleCustomResult(error);\r\n  }\r\n\r\n  checkInputOptionsValidity(): boolean {\r\n    if (!this.$input) {\r\n      return true;\r\n    }\r\n\r\n    const isRequired = this.$input.getAttribute('required') != null;\r\n    const optionWrappers = this.$input.querySelectorAll(this.options.inputOptionsSelector);\r\n    let result = true;\r\n\r\n    if (isRequired) {\r\n      for (const optionWrapper of optionWrappers) {\r\n        const input = optionWrapper.querySelector('input');\r\n\r\n        result = false;\r\n\r\n        // Only need one checked\r\n        if (input?.checked) {\r\n          result = true;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Get browser input validation message\r\n    const n = document.createElement('input');\r\n    n.required = isRequired;\r\n\r\n    if (result) {\r\n      n.value = 'placeholder';\r\n    }\r\n\r\n    n.checkValidity();\r\n\r\n    (this.$input as any).validationMessage = n.validationMessage;\r\n    (this.$input as any).validity = n.validity;\r\n\r\n    for (const optionWrapper of optionWrappers) {\r\n      const input = optionWrapper.querySelector<HTMLInputElement>('input');\r\n\r\n      input?.setCustomValidity(n.validationMessage);\r\n    }\r\n\r\n    if (!result) {\r\n      this.$input.dispatchEvent(\r\n        new CustomEvent('invalid')\r\n      );\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * @param valid {boolean}\r\n   */\r\n  updateValidClass(valid: Boolean) {\r\n    const $errorElement = this.getErrorElement();\r\n    const $invalidTarget = $errorElement?.previousElementSibling;\r\n\r\n    this.$input?.classList.remove(this.invalidClass);\r\n    this.$input?.classList.remove(this.validClass);\r\n    this.el.classList.remove(this.invalidClass);\r\n    this.el.classList.remove(this.validClass);\r\n    $invalidTarget?.classList.remove(this.invalidClass);\r\n    $invalidTarget?.classList.remove(this.validClass);\r\n\r\n    if (valid) {\r\n      this.$input?.classList.add(this.validClass);\r\n      this.el.classList.add(this.validClass);\r\n\r\n      $invalidTarget?.classList.add(this.validClass);\r\n    } else {\r\n      this.$input?.classList.add(this.invalidClass);\r\n      this.el.classList.add(this.invalidClass);\r\n\r\n      $invalidTarget?.classList.add(this.invalidClass);\r\n    }\r\n  }\r\n\r\n  getFormValidation(element?: Nullable<HTMLFormElement>): UnicornFormValidation | null {\r\n    return getBoundedInstance(element || this.getForm(), 'form.validation')!;\r\n  }\r\n\r\n  getValidator(name: string): [Validator, Record<string, any>] | null {\r\n    const matches = name.match(/(?<type>[\\w\\-_]+)(\\((?<params>.*)\\))*/);\r\n\r\n    if (!matches) {\r\n      return null;\r\n    }\r\n\r\n    const validatorName = matches.groups?.type || '';\r\n\r\n    const params = matches.groups?.params || '';\r\n\r\n    const fv = this.getFormValidation(this.$form!);\r\n    const validator = fv?.validators[validatorName] || UnicornFormValidation.globalValidators[validatorName];\r\n\r\n    if (!validator) {\r\n      return null;\r\n    }\r\n\r\n    const paramMatches = params.matchAll(/(?<key>\\w+)(\\s?[=:]\\s?(?<value>\\w+))?/g);\r\n    const options: Record<string, string> = {};\r\n\r\n    for (const paramMatch of paramMatches) {\r\n      const match = paramMatch?.groups as {\r\n        key: string;\r\n        value: string;\r\n      } | undefined;\r\n\r\n      if (!match) {\r\n        continue;\r\n      }\r\n\r\n      options[match.key] = handleParamValue(match.value);\r\n    }\r\n\r\n    return [ validator, options ];\r\n  }\r\n\r\n  handleCustomResult(result: boolean | string | undefined, validator?: Nullable<Validator>): boolean {\r\n    if (typeof result === 'string') {\r\n      this.$input?.setCustomValidity(result);\r\n      result = result === '';\r\n    } else if (result === undefined) {\r\n      result = true;\r\n    }\r\n\r\n    if (result) {\r\n      this.$input?.setCustomValidity('');\r\n    } else if (validator) {\r\n      this.raiseCustomErrorState(validator);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  handleAsyncCustomResult(result: boolean, validator?: Nullable<Validator>): boolean {\r\n    result = this.handleCustomResult(result, validator);\r\n\r\n    // Fire invalid events\r\n    this.$input?.checkValidity();\r\n\r\n    this.updateValidClass(result);\r\n\r\n    return result;\r\n  }\r\n\r\n  raiseCustomErrorState(validator: Validator): void {\r\n    let help;\r\n\r\n    if (this.$input?.validationMessage === '') {\r\n      help = validator.options?.notice;\r\n\r\n      if (typeof help === 'function') {\r\n        help = help(this.$input, this);\r\n      }\r\n\r\n      if (help != null) {\r\n        this.$input?.setCustomValidity(help);\r\n      }\r\n    }\r\n\r\n    if (this.$input?.validationMessage === '') {\r\n      this.$input?.setCustomValidity(trans('unicorn.message.validation.custom.error'));\r\n    }\r\n\r\n    this.$input?.dispatchEvent(\r\n      new CustomEvent('invalid')\r\n    );\r\n  }\r\n\r\n  setAsInvalidAndReport(error: string) {\r\n    this.setCustomValidity(error);\r\n    this.showInvalidResponse();\r\n  }\r\n\r\n  setCustomValidity(error: string) {\r\n    this.$input?.setCustomValidity(error);\r\n  }\r\n\r\n  reportValidity() {\r\n    if (this.validationMessage !== '') {\r\n      this.showInvalidResponse();\r\n    }\r\n  }\r\n\r\n  showInvalidResponse() {\r\n    /** @type ValidityState */\r\n    const state = this.$input?.validity;\r\n    let message: string = this.$input?.validationMessage || '';\r\n\r\n    for (let key in state) {\r\n      if (state[(key as keyof ValidityState)] && this.$input?.dataset[key + 'Message']) {\r\n        message = this.$input?.dataset[key + 'Message'] || '';\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!this.isVisible) {\r\n      let title = this.findLabel()?.textContent;\r\n\r\n      if (!title) {\r\n        title = this.$input?.name || '';\r\n      }\r\n\r\n      useUITheme().renderMessage(\r\n        `Field: ${title} - ${message}`,\r\n        'warning'\r\n      );\r\n    }\r\n\r\n    let $help = this.getErrorElement();\r\n\r\n    if (!$help) {\r\n      $help = this.createHelpElement()!;\r\n      this.el.appendChild($help);\r\n      this.prepareWrapper();\r\n    }\r\n\r\n    $help.textContent = message;\r\n\r\n    this.updateValidClass(false);\r\n  }\r\n\r\n  getErrorElement() {\r\n    return this.el.querySelector(this.errorSelector);\r\n  }\r\n\r\n  createHelpElement() {\r\n    const className = this.options.errorMessageClass;\r\n    const parsed = this.parseSelector(this.errorSelector || '');\r\n\r\n    const $help = html(`<div class=\"${className}\"></div>`)!;\r\n\r\n    $help.classList.add(...parsed.classes);\r\n\r\n    parsed.attrs.forEach((attr) => {\r\n      $help.setAttribute(attr[0], attr[1] || '');\r\n    });\r\n\r\n    parsed.ids.forEach((id) => {\r\n      $help.id = id;\r\n    });\r\n\r\n    return $help;\r\n  }\r\n\r\n  /**\r\n   * @see https://stackoverflow.com/a/17888178\r\n   */\r\n  parseSelector(subselector: string): { tags: string[]; classes: string[]; ids: string[]; attrs: string[][] } {\r\n    const obj: {\r\n      tags: string[];\r\n      classes: string[];\r\n      ids: string[];\r\n      attrs: string[][];\r\n    } = { tags: [], classes: [], ids: [], attrs: [] };\r\n    for (const token of subselector.split(/(?=\\.)|(?=#)|(?=\\[)/)) {\r\n      switch (token[0]) {\r\n        case '#':\r\n          obj.ids.push(token.slice(1));\r\n          break;\r\n        case '.':\r\n          obj.classes.push(token.slice(1));\r\n          break;\r\n        case '[':\r\n          obj.attrs.push(token.slice(1, -1).split('='));\r\n          break;\r\n        default :\r\n          obj.tags.push(token);\r\n          break;\r\n      }\r\n    }\r\n    return obj;\r\n  }\r\n\r\n  setAsValidAndClearResponse() {\r\n    this.setCustomValidity('');\r\n    this.updateValidClass(true);\r\n    this.clearInvalidResponse();\r\n  }\r\n\r\n  clearInvalidResponse() {\r\n    const $help = this.el.querySelector(this.errorSelector)!;\r\n\r\n    $help.textContent = '';\r\n  }\r\n\r\n  getForm() {\r\n    return this.el.closest(this.options.formSelector || '[uni-form-validate]') as HTMLFormElement;\r\n  }\r\n\r\n  findLabel() {\r\n    const id = this.$input?.id || '';\r\n\r\n    const wrapper = this.$input?.closest('[data-field-wrapper]');\r\n    let label = null;\r\n\r\n    if (wrapper) {\r\n      label = wrapper.querySelector('[data-field-label]');\r\n    }\r\n\r\n    if (!label) {\r\n      label = document.querySelector(`label[for=\"${id}\"]`);\r\n    }\r\n\r\n    return label;\r\n  }\r\n}\r\n\r\nfunction camelTo(str: string, sep: string) {\r\n  return str.replace(/([a-z])([A-Z])/g, `$1${sep}$2`).toLowerCase();\r\n}\r\n\r\nvalidatorHandlers.username = function (value: any, element: HTMLElement) {\r\n  const regex = new RegExp('[\\<|\\>|\"|\\'|\\%|\\;|\\(|\\)|\\&]', 'i');\r\n  return !regex.test(value);\r\n};\r\n\r\nvalidatorHandlers.numeric = function (value: any, element: HTMLElement) {\r\n  const regex = /^(\\d|-)?(\\d|,)*\\.?\\d*$/;\r\n  return regex.test(value);\r\n};\r\n\r\nvalidatorHandlers.email = function (value: any, element: HTMLElement) {\r\n  value = punycode.toASCII(value);\r\n  const regex = /^[a-zA-Z0-9.!#$%&â€™*+\\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/;\r\n  return regex.test(value);\r\n};\r\n\r\nvalidatorHandlers.url = function (value: any, element: HTMLElement) {\r\n  const regex = /^(?:(?:https?|ftp):\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!10(?:\\.\\d{1,3}){3})(?!127(?:\\.\\d{1,3}){3})(?!169\\.254(?:\\.\\d{1,3}){2})(?!192\\.168(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:\\/[^\\s]*)?$/i;\r\n  return regex.test(value);\r\n};\r\n\r\nvalidatorHandlers.alnum = function (value: any, element: HTMLElement) {\r\n  const regex = /^[a-zA-Z0-9]*$/;\r\n  return regex.test(value);\r\n};\r\n\r\nvalidatorHandlers.color = function (value: any, element: HTMLElement) {\r\n  const regex = /^#(?:[0-9a-f]{3}){1,2}$/;\r\n  return regex.test(value);\r\n};\r\n\r\n/**\r\n * @see  http://www.virtuosimedia.com/dev/php/37-tested-php-perl-and-javascript-regular-expressions\r\n */\r\nvalidatorHandlers.creditcard = function (value: any, element: HTMLElement) {\r\n  const regex = /^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6011[0-9]{12}|622((12[6-9]|1[3-9][0-9])|([2-8][0-9][0-9])|(9(([0-1][0-9])|(2[0-5]))))[0-9]{10}|64[4-9][0-9]{13}|65[0-9]{14}|3(?:0[0-5]|[68][0-9])[0-9]{11}|3[47][0-9]{13})*$/;\r\n  return regex.test(value);\r\n};\r\n\r\nvalidatorHandlers.ip = function (value: any, element: HTMLElement) {\r\n  const regex = /^((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))*$/;\r\n  return regex.test(value);\r\n};\r\n\r\nvalidatorHandlers['password-confirm'] = function (value: any, element: HTMLElement) {\r\n  const selector = element.dataset.confirmTarget;\r\n\r\n  if (!selector) {\r\n    throw new Error('Validator: \"password-confirm\" must add \"data-confirm-target\" attribute.');\r\n  }\r\n\r\n  const target = document.querySelector<HTMLInputElement>(selector);\r\n\r\n  return target?.value === value;\r\n};\r\n\r\nexport { validatorHandlers as validators };\r\n\r\n// customElements.define(UnicornFormValidateElement.is, UnicornFormValidateElement);\r\n// customElements.define(UnicornFieldValidateElement.is, UnicornFieldValidateElement);\r\n\r\nexport const ready = Promise.all([\r\n  useUniDirective('form-validate', {\r\n    mounted(el, binding) {\r\n      getBoundedInstance(el, 'form.validation', (ele) => {\r\n        return new UnicornFormValidation(ele as HTMLElement, JSON.parse(binding.value || '{}'));\r\n      });\r\n    },\r\n    updated(el, binding) {\r\n      const instance = getBoundedInstance<UnicornFormValidation>(el, 'form.validation');\r\n      instance.mergeOptions(JSON.parse(binding.value || '{}'));\r\n    }\r\n  }),\r\n\r\n  useUniDirective('field-validate', {\r\n    mounted(el, binding) {\r\n      getBoundedInstance<UnicornFieldValidation>(el, 'field.validation', (ele) => {\r\n        return new UnicornFieldValidation(ele as HTMLElement, JSON.parse(binding.value || '{}'));\r\n      });\r\n    },\r\n\r\n    updated(el, binding) {\r\n      const instance = getBoundedInstance<UnicornFieldValidation>(el, 'field.validation');\r\n      instance.mergeOptions(JSON.parse(binding.value || '{}') || {});\r\n    }\r\n  })\r\n]);\r\n\r\nfunction handleParamValue(value: any) {\r\n  if (!isNaN(Number(value))) {\r\n    return Number(value);\r\n  }\r\n\r\n  if (value === 'null') {\r\n    return null;\r\n  }\r\n\r\n  if (value === 'true') {\r\n    return true;\r\n  }\r\n\r\n  if (value === 'false') {\r\n    return true;\r\n  }\r\n\r\n  return value;\r\n}\r\n\r\nexport interface ValidationModule {\r\n  UnicornFormValidation: typeof UnicornFormValidation;\r\n  UnicornFieldValidation: typeof UnicornFieldValidation;\r\n  ready: Promise<any>;\r\n  validators: typeof validatorHandlers;\r\n}\r\n"],"names":["result","error","punycode.toASCII"],"mappings":"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","x_google_ignoreList":[0]}