import { d as data } from "../data.js";
function encode(obj, pfx) {
  var k, i, tmp, str = "";
  for (k in obj) {
    if ((tmp = obj[k]) !== void 0) {
      if (Array.isArray(tmp)) {
        for (i = 0; i < tmp.length; i++) {
          str && (str += "&");
          str += encodeURIComponent(k) + "=" + encodeURIComponent(tmp[i]);
        }
      } else {
        str && (str += "&");
        str += encodeURIComponent(k) + "=" + encodeURIComponent(tmp);
      }
    }
  }
  return "" + str;
}
function toValue(mix) {
  if (!mix) return "";
  var str = decodeURIComponent(mix);
  if (str === "false") return false;
  if (str === "true") return true;
  return +str * 0 === 0 ? +str : str;
}
function decode(str) {
  var tmp, k, out = {}, arr = str.split("&");
  while (tmp = arr.shift()) {
    tmp = tmp.split("=");
    k = tmp.shift();
    if (out[k] !== void 0) {
      out[k] = [].concat(out[k], toValue(tmp.shift()));
    } else {
      out[k] = toValue(tmp.shift());
    }
  }
  return out;
}
function addRoute(route2, url) {
  const routes = data("unicorn.routes") || {};
  routes[route2] = url;
  data("unicorn.routes", routes);
}
function route(route2, query) {
  const source = route2;
  const extract = extractRoute(source);
  route2 = extract.route;
  let path = extract.path;
  const routes = data("unicorn.routes") || {};
  let url = routes[route2];
  if (url == null) {
    if (!route2.startsWith("@")) {
      route2 = "@" + route2;
    } else {
      route2 = route2.substring(1);
    }
  }
  url = routes[route2];
  if (url == null) {
    throw new Error(`Route: "${source}" not found`);
  }
  if (path) {
    const { route: u1, path: u1q } = extractRoute(url, "?");
    const { route: u2, path: u2q } = extractRoute(path, "?");
    url = u1 + "/" + u2;
    if (u1q || u2q) {
      const q = [u1q, u2q].filter((u) => u).join("&");
      url += "?" + q;
    }
  }
  return addQuery(url, query);
}
function extractRoute(route2, sep = "/") {
  if (route2.indexOf(sep) === -1) {
    return { route: route2, path: "" };
  }
  const segments = route2.split(sep);
  route2 = segments.shift() || "";
  const path = segments.join(sep);
  return { route: route2, path };
}
function hasRoute(route2) {
  return void 0 !== data("unicorn.routes")[route2];
}
function addQuery(url, query) {
  if (query == null) {
    return url;
  }
  for (let k in query) {
    const v = query[k];
    const placeholder = `{${k}}`;
    if (url.indexOf(placeholder) !== -1) {
      url = url.replace(
        new RegExp(`${placeholder}`, "g"),
        v
      );
      delete query[k];
    }
    const encodedPlaceholder = encodeURIComponent(`{${k}}`);
    if (url.indexOf(encodedPlaceholder) !== -1) {
      url = url.replace(
        new RegExp(`${encodedPlaceholder}`, "g"),
        v
      );
      delete query[k];
    }
  }
  if (Object.keys(query).length === 0) {
    return url;
  }
  const queryString = encode(query);
  return url + (/\?/.test(url) ? `&${queryString}` : `?${queryString}`);
}
function parseQuery(queryString) {
  return decode(queryString);
}
function buildQuery(query) {
  return encode(query);
}
export {
  addRoute as a,
  addQuery as b,
  buildQuery as c,
  hasRoute as h,
  parseQuery as p,
  route as r
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGVyLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvcXNzL2Rpc3QvcXNzLm1qcyIsIi4uLy4uLy4uL3NyYy9zZXJ2aWNlL3JvdXRlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gZW5jb2RlKG9iaiwgcGZ4KSB7XG5cdHZhciBrLCBpLCB0bXAsIHN0cj0nJztcblxuXHRmb3IgKGsgaW4gb2JqKSB7XG5cdFx0aWYgKCh0bXAgPSBvYmpba10pICE9PSB2b2lkIDApIHtcblx0XHRcdGlmIChBcnJheS5pc0FycmF5KHRtcCkpIHtcblx0XHRcdFx0Zm9yIChpPTA7IGkgPCB0bXAubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRzdHIgJiYgKHN0ciArPSAnJicpO1xuXHRcdFx0XHRcdHN0ciArPSBlbmNvZGVVUklDb21wb25lbnQoaykgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQodG1wW2ldKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0c3RyICYmIChzdHIgKz0gJyYnKTtcblx0XHRcdFx0c3RyICs9IGVuY29kZVVSSUNvbXBvbmVudChrKSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh0bXApO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHJldHVybiAocGZ4IHx8ICcnKSArIHN0cjtcbn1cblxuZnVuY3Rpb24gdG9WYWx1ZShtaXgpIHtcblx0aWYgKCFtaXgpIHJldHVybiAnJztcblx0dmFyIHN0ciA9IGRlY29kZVVSSUNvbXBvbmVudChtaXgpO1xuXHRpZiAoc3RyID09PSAnZmFsc2UnKSByZXR1cm4gZmFsc2U7XG5cdGlmIChzdHIgPT09ICd0cnVlJykgcmV0dXJuIHRydWU7XG5cdHJldHVybiAoK3N0ciAqIDAgPT09IDApID8gKCtzdHIpIDogc3RyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVjb2RlKHN0cikge1xuXHR2YXIgdG1wLCBrLCBvdXQ9e30sIGFycj1zdHIuc3BsaXQoJyYnKTtcblxuXHR3aGlsZSAodG1wID0gYXJyLnNoaWZ0KCkpIHtcblx0XHR0bXAgPSB0bXAuc3BsaXQoJz0nKTtcblx0XHRrID0gdG1wLnNoaWZ0KCk7XG5cdFx0aWYgKG91dFtrXSAhPT0gdm9pZCAwKSB7XG5cdFx0XHRvdXRba10gPSBbXS5jb25jYXQob3V0W2tdLCB0b1ZhbHVlKHRtcC5zaGlmdCgpKSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdG91dFtrXSA9IHRvVmFsdWUodG1wLnNoaWZ0KCkpO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBvdXQ7XG59XG4iLCJcclxuaW1wb3J0IHsgZGF0YSB9IGZyb20gJy4uL2RhdGEnO1xyXG5pbXBvcnQgeyBkZWNvZGUsIGVuY29kZSB9IGZyb20gJ3Fzcyc7XHJcblxyXG4vKipcclxuICogQWRkIGEgcm91dGUuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYWRkUm91dGUocm91dGU6IHN0cmluZywgdXJsOiBzdHJpbmcpIHtcclxuICBjb25zdCByb3V0ZXMgPSBkYXRhKCd1bmljb3JuLnJvdXRlcycpIHx8IHt9O1xyXG4gIHJvdXRlc1tyb3V0ZV0gPSB1cmw7XHJcblxyXG4gIGRhdGEoJ3VuaWNvcm4ucm91dGVzJywgcm91dGVzKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCByb3V0ZS5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByb3V0ZShyb3V0ZTogc3RyaW5nLCBxdWVyeT86IFJlY29yZDxzdHJpbmcsIGFueT4pOiBzdHJpbmcge1xyXG4gIGNvbnN0IHNvdXJjZSA9IHJvdXRlO1xyXG4gIGNvbnN0IGV4dHJhY3QgPSBleHRyYWN0Um91dGUoc291cmNlKTtcclxuICByb3V0ZSA9IGV4dHJhY3Qucm91dGU7XHJcbiAgbGV0IHBhdGggPSBleHRyYWN0LnBhdGg7XHJcbiAgY29uc3Qgcm91dGVzID0gZGF0YSgndW5pY29ybi5yb3V0ZXMnKSB8fCB7fTtcclxuXHJcbiAgbGV0IHVybCA9IHJvdXRlc1tyb3V0ZV07XHJcblxyXG4gIGlmICh1cmwgPT0gbnVsbCkge1xyXG4gICAgaWYgKCFyb3V0ZS5zdGFydHNXaXRoKCdAJykpIHtcclxuICAgICAgcm91dGUgPSAnQCcgKyByb3V0ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJvdXRlID0gcm91dGUuc3Vic3RyaW5nKDEpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgdXJsID0gcm91dGVzW3JvdXRlXTtcclxuXHJcbiAgaWYgKHVybCA9PSBudWxsKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFJvdXRlOiBcIiR7c291cmNlfVwiIG5vdCBmb3VuZGApO1xyXG4gIH1cclxuXHJcbiAgLy8gTWVyZ2UgcXVlcnlcclxuICBpZiAocGF0aCkge1xyXG4gICAgY29uc3QgeyByb3V0ZTogdTEsIHBhdGg6IHUxcSB9ID0gZXh0cmFjdFJvdXRlKHVybCwgJz8nKTtcclxuICAgIGNvbnN0IHsgcm91dGU6IHUyLCBwYXRoOiB1MnEgfSA9IGV4dHJhY3RSb3V0ZShwYXRoLCAnPycpO1xyXG5cclxuICAgIHVybCA9IHUxICsgJy8nICsgdTI7XHJcblxyXG4gICAgaWYgKHUxcSB8fCB1MnEpIHtcclxuICAgICAgY29uc3QgcSA9IFsgdTFxLCB1MnEgXS5maWx0ZXIodSA9PiB1KS5qb2luKCcmJyk7XHJcbiAgICAgIHVybCArPSAnPycgKyBxO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGFkZFF1ZXJ5KHVybCwgcXVlcnkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBleHRyYWN0Um91dGUocm91dGU6IHN0cmluZywgc2VwOiBzdHJpbmcgPSAnLycpOiB7IHBhdGg6IHN0cmluZzsgcm91dGU6IHN0cmluZyB9IHtcclxuICBpZiAocm91dGUuaW5kZXhPZihzZXApID09PSAtMSkge1xyXG4gICAgcmV0dXJuIHsgcm91dGUsIHBhdGg6ICcnIH1cclxuICB9XHJcblxyXG4gIGNvbnN0IHNlZ21lbnRzID0gcm91dGUuc3BsaXQoc2VwKTtcclxuXHJcbiAgcm91dGUgPSBzZWdtZW50cy5zaGlmdCgpIHx8ICcnO1xyXG4gIGNvbnN0IHBhdGggPSBzZWdtZW50cy5qb2luKHNlcCk7XHJcblxyXG4gIHJldHVybiB7IHJvdXRlLCBwYXRoIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNSb3V0ZShyb3V0ZTogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIHVuZGVmaW5lZCAhPT0gZGF0YSgndW5pY29ybi5yb3V0ZXMnKVtyb3V0ZV07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRRdWVyeSh1cmw6IHN0cmluZywgcXVlcnk/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogc3RyaW5nIHtcclxuICBpZiAocXVlcnkgPT0gbnVsbCkge1xyXG4gICAgcmV0dXJuIHVybDtcclxuICB9XHJcblxyXG4gIGZvciAobGV0IGsgaW4gcXVlcnkpIHtcclxuICAgIGNvbnN0IHYgPSBxdWVyeVtrXTtcclxuXHJcbiAgICBjb25zdCBwbGFjZWhvbGRlciA9IGB7JHtrfX1gO1xyXG5cclxuICAgIGlmICh1cmwuaW5kZXhPZihwbGFjZWhvbGRlcikgIT09IC0xKSB7XHJcbiAgICAgIHVybCA9IHVybC5yZXBsYWNlKFxyXG4gICAgICAgIG5ldyBSZWdFeHAoYCR7cGxhY2Vob2xkZXJ9YCwgJ2cnKSxcclxuICAgICAgICB2XHJcbiAgICAgICk7XHJcbiAgICAgIGRlbGV0ZSBxdWVyeVtrXTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBlbmNvZGVkUGxhY2Vob2xkZXIgPSBlbmNvZGVVUklDb21wb25lbnQoYHske2t9fWApO1xyXG5cclxuICAgIGlmICh1cmwuaW5kZXhPZihlbmNvZGVkUGxhY2Vob2xkZXIpICE9PSAtMSkge1xyXG4gICAgICB1cmwgPSB1cmwucmVwbGFjZShcclxuICAgICAgICBuZXcgUmVnRXhwKGAke2VuY29kZWRQbGFjZWhvbGRlcn1gLCAnZycpLFxyXG4gICAgICAgIHZcclxuICAgICAgKTtcclxuICAgICAgZGVsZXRlIHF1ZXJ5W2tdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaWYgKE9iamVjdC5rZXlzKHF1ZXJ5KS5sZW5ndGggPT09IDApIHtcclxuICAgIHJldHVybiB1cmw7XHJcbiAgfVxyXG5cclxuICBjb25zdCBxdWVyeVN0cmluZyA9IGVuY29kZShxdWVyeSk7XHJcblxyXG4gIHJldHVybiB1cmwgKyAoL1xcPy8udGVzdCh1cmwpID8gYCYke3F1ZXJ5U3RyaW5nfWAgOiBgPyR7cXVlcnlTdHJpbmd9YCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVF1ZXJ5PFQgPSBSZWNvcmQ8c3RyaW5nLCBhbnk+PihxdWVyeVN0cmluZzogc3RyaW5nKTogVCB7XHJcbiAgcmV0dXJuIGRlY29kZShxdWVyeVN0cmluZykgYXMgVDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkUXVlcnkocXVlcnk6IFJlY29yZDxzdHJpbmcsIGFueT4pOiBzdHJpbmcge1xyXG4gIHJldHVybiBlbmNvZGUocXVlcnkpO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJyb3V0ZSJdLCJtYXBwaW5ncyI6IjtBQUFPLFNBQVMsT0FBTyxLQUFLLEtBQUs7QUFDaEMsTUFBSSxHQUFHLEdBQUcsS0FBSyxNQUFJO0FBRW5CLE9BQUssS0FBSyxLQUFLO0FBQ2QsU0FBSyxNQUFNLElBQUksQ0FBQyxPQUFPLFFBQVE7QUFDOUIsVUFBSSxNQUFNLFFBQVEsR0FBRyxHQUFHO0FBQ3ZCLGFBQUssSUFBRSxHQUFHLElBQUksSUFBSSxRQUFRLEtBQUs7QUFDOUIsa0JBQVEsT0FBTztBQUNmLGlCQUFPLG1CQUFtQixDQUFDLElBQUksTUFBTSxtQkFBbUIsSUFBSSxDQUFDLENBQUM7QUFBQSxRQUMvRDtBQUFBLE1BQ0QsT0FBTztBQUNOLGdCQUFRLE9BQU87QUFDZixlQUFPLG1CQUFtQixDQUFDLElBQUksTUFBTSxtQkFBbUIsR0FBRztBQUFBLE1BQzVEO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFFQSxTQUFlLEtBQU07QUFDdEI7QUFFQSxTQUFTLFFBQVEsS0FBSztBQUNy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
